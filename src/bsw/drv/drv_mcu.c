/*******************************************************************************
 * @file        drv_mcu.c
 * @author      Modulo Medito (chcchc1995@outlook.com)
 * @brief
 *
 * @version     0.0.1
 * @date        2024-07-25
 * @copyright   Copyright (C) 2024. All rights reserved.
 ******************************************************************************/
/******************************************************************************/
/* INCLUDE                                                                    */
/******************************************************************************/
#include "drv_mcu.h"

/******************************************************************************/
/* DEFINE                                                                     */
/******************************************************************************/

/******************************************************************************/
/* TYPEDEF                                                                    */
/******************************************************************************/

/******************************************************************************/
/* ENUM                                                                       */
/******************************************************************************/

/******************************************************************************/
/* STRUCTURE                                                                  */
/******************************************************************************/

/******************************************************************************/
/* UNION                                                                      */
/******************************************************************************/

/******************************************************************************/
/* LOCAL INLINE FUNCTION DECLARATION                                          */
/******************************************************************************/

/******************************************************************************/
/* LOCAL FUNCTION DECLARATION                                                 */
/******************************************************************************/

/******************************************************************************/
/* GLOBAL FUNCTION DECLARATION                                                */
/******************************************************************************/

/******************************************************************************/
/* LOCAL VARIABLE DEFINITION                                                  */
/******************************************************************************/

/******************************************************************************/
/* GLOBAL VARIABLE DEFINITION                                                 */
/******************************************************************************/

/******************************************************************************/
/* GLOBAL FUNCTION DEFINITION                                                 */
/******************************************************************************/
void drv_mcu_init() {
    /** Initialize device clock and peripherals */
    Device_init();

    /** Initialize PIE and clear PIE registers. Disables CPU interrupts. */
    mcu_int_INIT_MODULE();

    /** Initialize GPIO and unlock the GPIO configuration registers */
    Device_initGPIO();

    /** Disable CPU interrupts */
    mcu_ctl_INTERRUPT_DISABLE();

    /** Disable CPU interrupts and clear all CPU interrupt flags */
    drv_mcu_clear_all_interrupt_flags();

    /**
     * Initialize the PIE vector table with pointers to the shell Interrupt
     * Service Routines (ISR).
     */
    mcu_int_INIT_VECTOR_TABLE();
}

void drv_mcu_clear_all_interrupt_flags() {
    mcu_ctl_CLEAR_INTERRUPT_ENABLE_FLAGS();
    mcu_ctl_CLEAR_INTERRUPT_INDICATION_FLAGS();
}

/******************************************************************************/
/* LOCAL FUNCTION DEFINITION                                                  */
/******************************************************************************/

/******************************************************************************/
/* LOCAL INLINE FUNCTION DEFINITION                                           */
/******************************************************************************/
